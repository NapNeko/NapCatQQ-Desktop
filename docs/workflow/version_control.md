# 版本控制规范

## 概述

本文档规定了项目的版本控制工作流程，包括Issue管理、分支策略和PR（Pull Request）流程。遵循这些规范有助于保持代码库的整洁，提高团队协作效率。

## 1. Issue 管理

### 原则

无论是新增功能、优化、修复bug、重构或其他任务，必须先创建Issue并明确目标，再开始工作。

### 命名规范

Issue标题格式：`[类型] 描述`

类型建议使用统一前缀：

- `[feat]` 新功能
- `[fix]` 修复bug
- `[refactor]` 代码重构
- `[docs]` 文档更新
- `[chore]` 构建/工具/其他杂项
- `[test]` 测试相关
- `[perf]` 性能优化
- `[style]` 代码风格调整（不影响代码运行的变动）

示例：
[feat] 添加用户信息导出功能
[fix] 修复登录界面闪退问题
[refactor] 统一项目命名规范（变量/函数/信号槽）
[docs] 补充命名规范说明
[test] 增加用户模块单元测试
### Issue内容要求

一个完整的Issue应包含：

1. 问题描述或功能需求
2. 预期行为
3. 实际行为（bug类Issue）
4. 复现步骤（bug类Issue）
5. 相关截图或日志（如适用）
6. 优先级和里程碑（可选）

## 2. 分支管理

### 主分支

- `main` 或 `master`：始终保持可部署状态，不直接提交代码
- 保护主分支，只允许通过PR合并代码

### 开发分支

- `develop`：开发主分支，用于集成多个feature分支
- 从`main`分支创建，完成一个版本后合并回`main`

### 功能/任务分支

分支命名规则：`<类型>/<issue编号>-<简短描述>`

- `<类型>` 与Issue类型一致，例如 `feat`, `fix`, `refactor`, `docs`
- `<issue编号>` 关联对应Issue，如 `12`（去掉#号）
- `<简短描述>` 使用 `snake_case` 简述任务

示例：
feat/12-add_user_export
fix/15-login_crash
refactor/8-unify_naming
docs/20-update_convention
test/25-add_user_tests
### 发布分支

- 命名格式：`release/v<版本号>`
- 示例：`release/v1.0.0`, `release/v2.1.0`
- 从`develop`分支创建，完成后合并到`main`和`develop`

### 热修复分支

- 命名格式：`hotfix/<issue编号>-<描述>`
- 示例：`hotfix/32-fix_critical_error`
- 从`main`分支创建，修复后合并到`main`和`develop`

## 3. 提交信息规范

提交信息应清晰描述本次提交的内容，格式如下：
[类型] 简短描述（不超过50字符）

详细描述（可选，换行后填写）

关联Issue: #12
类型与Issue类型一致，示例：
[feat] 添加用户信息导出功能

- 实现用户数据导出为CSV格式
- 添加导出按钮和相关菜单
- 实现导出进度提示

关联Issue: #12[fix] 修复登录界面闪退问题

修复了在输入过长用户名时的崩溃问题
增加了输入长度验证

关联Issue: #15
## 4. PR（Pull Request / Merge Request）管理

### 基本原则

- PR必须关联对应的Issue
- 小型PR优先（建议每次PR不超过300行代码变更）
- 提交PR前确保所有测试通过
- 代码符合项目规范

### PR标题规范

与分支类型一致，简洁描述改动：
[feat] 添加用户信息导出功能 (#12)
[fix] 修复登录界面闪退 (#15)
[refactor] 统一项目命名规范 (#8)
### PR内容要求

1. 说明本次改动的目的
2. 改动涉及的主要文件/模块
3. 实现思路和关键技术点
4. 说明是否有破坏性改动或兼容性注意事项
5. 测试方法和验证步骤
6. 关联对应Issue，并在Issue中标注进度或完成状态

### PR模板

建议使用以下PR模板：
## 描述
<!-- 简要描述本次PR的内容和目的 -->

## 关联Issue
<!-- 引用关联的Issue，例如: Fixes #12 -->
Fixes #

## 改动内容
- <!-- 列出主要改动点 -->
- 

## 测试情况
<!-- 描述测试方法和结果 -->

## 注意事项
<!-- 有哪些需要特别注意的地方，如破坏性改动等 -->

## 截图（如适用）
<!-- 相关截图 -->
## 5. 代码审查规范

1. 至少需要1名团队成员审查通过才能合并
2. 审查重点：
   - 代码是否符合项目规范
   - 功能是否完整实现
   - 是否有潜在的bug
   - 代码可读性和可维护性
   - 测试覆盖率
3. 审查意见应具体、建设性，避免模糊的评价
4. 作者应及时回应并处理审查意见

## 6. 工作流程建议

1. 从主分支（`main`或`develop`）拉出新分支开发
2. 在分支上完成开发与测试
3. 定期从源分支同步最新代码，解决冲突
4. 提交PR，并关联对应Issue
5. 完成代码审查，根据意见修改代码
6. 所有CI检查通过后，合并PR
7. PR合并后，删除功能分支
8. 关闭对应Issue，并更新相关文档

通过遵循以上流程，可以有效管理项目进度，减少代码冲突，提高代码质量，促进团队高效协作。
